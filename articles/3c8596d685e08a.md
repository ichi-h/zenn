---
title: "OpenAPIが辛いのでTypeScript & Zodで書けるようにした話"
emoji: ""
type: "tech" # tech: 技術記事 / idea: アイデア
topics: []
published: false
---

## OpenAPI、辛くありませんか？

弊社ではスキーマ駆動開発を採用しており、API の仕様を OpenAPI で定義してからバックエンド・フロントエンドの開発をスタートする体制を取っています。  
そのため、開発の前に先にスキーマを定義する必要がある都合上、生の YAML ファイルの OpenAPI を手動で書く必要があるのですが、この開発体験が最悪でして、エンジニアの精神衛生上あまりよろしくない問題を抱えておりました。  
VSCode でインテリセンスを効かせたり、YAML ファイルを分割したり、Linter を導入して静的解析を回したりなど……色々と手を打ってきたのですが、それでもミスるときはミスりますし、またそもそもの「YAML を手動で書く」という行為自体が辛いので、大きな新規開発でスキーマを書く際に心理的ハードルが上がってしまうという状況が続いていました。

やはりエンジニアたるもの「Lazy」でいたいものですので、なんとか

## どうやって書くのか

## 全体構成

```mermaid
graph TD
  classDef ts fill:#007ACC,color:#fff
  classDef go fill:#00ADD8,color:#fff
  classDef php fill:#777BB4,color:#fff
  classDef vercel fill:#000000,color:#fff
  classDef openapi fill:#85EA2D,color:#000000
  classDef react fill:#61DAFB,color:#000000
  classDef redoc fill:#7E57C2,color:#fff

  subgraph OpenAPIRepository
    subgraph Project2Schema["Project2"]
      Project2TsZodSchema[TypeScript + ZodSchema]:::ts
      Project2OpenAPI[OpenAPI]:::openapi
      Project2Client[TypeScriptClient]:::ts
      Project2Server[PHPServer]:::php
      Project2Docs[RedocHTML]:::redoc
      Project2TsZodSchema --"build"--> Project2OpenAPI
      Project2OpenAPI --"codegen"--> Project2Client
      Project2OpenAPI --"codegen"--> Project2Server
      Project2OpenAPI --"build"--> Project2Docs
    end
    subgraph Project1Schema["Project1"]
      Project1TsZodSchema[TypeScript + ZodSchema]:::ts
      Project1OpenAPI[OpenAPI]:::openapi
      Project1Client[TypeScriptClient]:::ts
      Project1Server[GoServer]:::go
      Project1Docs[RedocHTML]:::redoc
      Project1TsZodSchema --"build"--> Project1OpenAPI
      Project1OpenAPI --"codegen"--> Project1Client
      Project1OpenAPI --"codegen"--> Project1Server
      Project1OpenAPI --"build"--> Project1Docs
    end
  end

  subgraph Project2
    Project2FrontEnd[React]:::react
    Project2BackEnd[PHP]:::php
    Project2Client --"git submodule"--> Project2FrontEnd
    Project2Server --"git submodule"--> Project2BackEnd
  end

  subgraph Project1
    Project1FrontEnd[React]:::react
    Project1BackEnd[Go]:::go
    Project1Client --"git submodule"--> Project1FrontEnd
    Project1Server --"git submodule"--> Project1BackEnd
  end

  Vercel:::vercel
  Project1Docs --"Deploy"--> Vercel
  Project2Docs --"Deploy"--> Vercel
```

## 運用方法

## 導入するうえでの懸念

### バックエンドエンジニアが TypeScript を書くのはやりづらくないのか？

### ProtoBuf はどうなのか？

## おわりに
